<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright © Tanner Gooding and Contributors. Licensed under the MIT License (MIT). See License.md in the repository root for more information. -->
<!-- Ported from https://github.com/MicrosoftDocs/sdk-api/ -->
<doc>
  <member name="Windows.MultinetGetConnectionPerformance">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.MultinetGetConnectionPerformanceA">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.MultinetGetConnectionPerformanceW">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.MultinetGetConnectionPerformance">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.MultinetGetConnectionPerformanceA">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.MultinetGetConnectionPerformanceW">
    <summary>
      <para>The
<b>MultinetGetConnectionPerformance</b> function returns information about the expected performance of a connection used to access a network resource.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource. The following members have specific meanings in this context.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a buffer that specifies a local device, such as "F:" or "LPT1", that is redirected to a network resource to be queried.</para>
            <para>If this member is <b>NULL</b> or an empty string, the network resource is specified in the <i>lpRemoteName</i> member. If this flag specifies a local device, <i>lpRemoteName</i> is ignored.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a network resource to query. The resource must currently have an established connection. For example, if the resource is a file on a file server, then having the file open will ensure the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Usually set to <b>NULL</b>, but can be a pointer to the owner (provider) of the resource if the network on which the resource resides is known.</para>
            <para>If the <i>lpProvider</i> member is not <b>NULL</b>, the system attempts to return information only about the named network.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpNetConnectInfoStruct">
      <para>A pointer to the
<see cref="NETCONNECTINFOSTRUCT" /> structure that receives the data.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The network resource does not supply this information.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter does not specify a redirected device, or the <i>lpRemoteName</i> member does not specify the name of a resource that is currently connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <i>lpLocalName</i> member is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the  <i>lpNetResource</i> parameter was <b>NULL</b> and the <b>lpRemoteName</b> member of the <b>NETRESOURCE</b> structure pointed to by the  <i>lpNetResource</i> was also or <b>NULL</b> or could not recognized by any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt to access an invalid address. This error is returned if the <i>lpNetResource</i> or <i>lpNetConnectInfoStruct</i> parameters were <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A bad parameter was passed. This error is returned if the <i>lpNetConnectInfoStruct</i> parameter does not point to a
<see cref="NETCONNECTINFOSTRUCT" /> structure in which the <b>cbStructure</b> member is filled with the proper structure size.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call
<see cref="WNetGetLastError" />.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>MultinetGetConnectionPerformance</b> function returns the information in a
<see cref="NETCONNECTINFOSTRUCT" /> structure.</para>
      <para>The information returned by the
<b>MultinetGetConnectionPerformance</b> function is an estimate only. Network traffic and routing can affect the accuracy of the results returned.</para>
      <para>Note that the
<b>MultinetGetConnectionPerformance</b> function can be used only to request information for a local device that is redirected to a network resource, or for a network resource to which there is currently a connection.</para>
      <para>If a UNC path is specified in the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter,  the <b>lpRemoteName</b> member must be a directory name, not  a filename.</para>
      <para>A typical way to use this function would be to open a file on a network server (which would ensure that there is a connection to the file), call this function, and use the results to make decisions about how to manage file I/O. For example, you can decide whether to read the entire file into a temporary file on the client or directly access the file on the server.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines MultinetGetConnectionPerformance as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETCONNECTINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2A">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2W">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2A">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection2W">
    <summary>
      <para>The
<b>WNetAddConnection2</b> function makes a connection to a network resource and can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection2</b> function supersedes the
<see cref="WNetAddConnection" /> function. If you can pass a handle to a window that the provider of network resources can use as an owner window for dialog boxes, call the
<see cref="WNetAddConnection3" /> function instead.</para>
    </summary>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection2</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The possible values for the connection options are defined in the <i>Winnetwk.h</i> header file.
The following values can currently be used.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_PROFILE</b>
                </description>
              </item>
              <item>
                <description>0x00000001</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not try to restore the connection when the user logs on.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_UPDATE_RECENT</b>
                </description>
              </item>
              <item>
                <description>0x00000002</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be put in the recent connection list.</para>
            <para>If this flag is set and the connection is successfully added, the network resource connection will be put in the recent connection list only if it has a redirected local device associated with it.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_TEMPORARY</b>
                </description>
              </item>
              <item>
                <description>0x00000004</description>
              </item>
            </list>
          </description>
          <description>
            <para>The network resource connection should not be remembered.</para>
            <para>If this flag is set, the operating system will not attempt to restore the connection when the user logs on again.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_INTERACTIVE</b>
                </description>
              </item>
              <item>
                <description>0x00000008</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_PROMPT</b>
                </description>
              </item>
              <item>
                <description>0x00000010</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_REDIRECT</b>
                </description>
              </item>
              <item>
                <description>0x00000080</description>
              </item>
            </list>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CURRENT_MEDIA</b>
                </description>
              </item>
              <item>
                <description>0x00000200</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, then the operating system does  not start to use a new media to try to establish the connection (initiate a new dial up connection, for example).</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_COMMANDLINE</b>
                </description>
              </item>
              <item>
                <description>0x00000800</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CMD_SAVECRED</b>
                </description>
              </item>
              <item>
                <description>0x00001000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is ignored unless CONNECT_INTERACTIVE is also set. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows XP:  </b>This value is supported on Windows XP and later.</para>
          </description>
        </item>
        <item>
          <description>
            <list type="bullet">
              <item>
                <description>
                  <b>CONNECT_CRED_RESET</b>
                </description>
              </item>
              <item>
                <description>0x00002000</description>
              </item>
            </list>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential is reset by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows Vista:  </b>This value is supported on Windows Vista and later.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value can be one of the following error codes or one of the
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error codes</a>.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The specified device name is not valid. This error is returned if the <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a device that is not redirectable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The network name cannot be found. This value is returned if the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a resource that is not acceptable to any network resource provider, either because the resource name is empty, not valid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The specified network provider name is not valid. This error is returned if the <b>lpProvider</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that does not match any network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_USERNAME</b>
            </para>
          </description>
          <description>
            <para>The specified user name is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>The local device name has a remembered connection to another network resource. This error is returned if an entry for the device specified by <b>lpLocalName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value that is already in the user profile for a different connection than that specified in the
<i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>An attempt was made to access an invalid address. This error is returned if the <i>dwFlags</i> parameter specifies a value of CONNECT_REDIRECT, but the <b>lpLocalName</b> member  of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter was unspecified.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>A parameter is incorrect. This error is returned if the <b>dwType</b> member of the  <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter specifies a value other than RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY. This error is also returned if the <i>dwFlags</i> parameter specifies an incorrect or unknown value.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_LOGON_FAILURE</b>
            </para>
          </description>
          <description>
            <para>A logon failure because of an unknown user name or a bad password.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>No network provider accepted the given network path. This error is returned if no network provider recognized the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>Other</b>
            </para>
          </description>
          <description>
            <para>Use
<see cref="FormatMessage" /> to obtain the message string for the returned error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection2</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection2</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetAddConnection2</b> function to make connection to a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

// Need to link with Netapi32.lib and Mpr.lib

int wmain(int argc, wchar_t * argv[])
{

    DWORD dwRetVal;

    NETRESOURCE nr;
    DWORD dwFlags;

    if (argc != 5) {
        wprintf(L"Usage: %s &lt;localname&gt;&lt;remotename&gt;&lt;username&gt;&lt;password&gt;\n",
                argv[0]);
        wprintf(L"       %s X: \\\\contoso\\public testuser testpasswd\n",
                argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetAddConnection2 with\n");
    wprintf(L"  lpLocalName = %s\n", argv[1]);
    wprintf(L"  lpRemoteName = %s\n", argv[2]);
    wprintf(L"  lpUsername = %s\n", argv[3]);
    wprintf(L"  lpPassword = %s\n", argv[4]);

// Zero out the NETRESOURCE struct
    memset(&amp;amp;amp;amp;amp;amp;nr, 0, sizeof (NETRESOURCE));

// Assign our values to the NETRESOURCE structure.

    nr.dwType = RESOURCETYPE_ANY;
    nr.lpLocalName = argv[1];
    nr.lpRemoteName = argv[2];
    nr.lpProvider = NULL;

// Assign a value to the connection options
    dwFlags = CONNECT_UPDATE_PROFILE;
//
// Call the WNetAddConnection2 function to assign
//   a drive letter to the share.
//
    dwRetVal = WNetAddConnection2(&amp;amp;amp;amp;amp;amp;nr, argv[4], argv[3], dwFlags);
//
// If the call succeeds, inform the user; otherwise,
//  print the error.
//
    if (dwRetVal == NO_ERROR)
        wprintf(L"Connection added to %s\n", nr.lpRemoteName);
    else
        wprintf(L"WNetAddConnection2 failed with error: %u\n", dwRetVal);

    exit(1);
}


</code>
      <para>For other code samples that illustrates how to make a connection to a network resource using the
<b>WNetAddConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/adding-a-network-connection">Adding a Network Connection</a> and <a href="https://docs.microsoft.com//windows/desktop/WNet/assigning-a-drive-to-a-share">Assigning a Drive to a Share</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3A">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3W">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3A">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection3W">
    <summary>
      <para>The
<b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</para>
      <para>The
<b>WNetAddConnection3</b> function is similar to the
<see cref="WNetAddConnection2" /> function. The main difference is that
<b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes. The
<b>WNetAddConnection2</b> function and the
<b>WNetAddConnection3</b> function supersede the
<see cref="WNetAddConnection" /> function.</para>
    </summary>
    <param name="hwndOwner">
      <para>A handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
      <para>The <i>hwndOwner</i> parameter can be <b>NULL</b>. If it is, a call to
<b>WNetAddConnection3</b> is equivalent to calling the
<see cref="WNetAddConnection2" /> function.</para>
    </param>
    <param name="lpNetResource">
      <para>A pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection, such as information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<see cref="NETRESOURCE" /> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>The type of network resource to connect to.</para>
            <para>If the <b>lpLocalName</b> member points to a nonempty string, this member can be equal to RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
            <para>If <b>lpLocalName</b> is <b>NULL</b>, or if it points to an empty string, <b>dwType</b> can be equal to RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the name of a local device to redirect, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty or if <b>lpLocalName</b> is <b>NULL</b>, the function makes a connection to the network resource without redirecting a local device.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>A pointer to a <b>null</b>-terminated string that specifies the network provider to connect to.</para>
            <para>If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetAddConnection3</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by the <i>lpUserName</i> parameter.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserName</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="dwFlags">
      <para>A set of connection options. The following values are currently defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows Server 2003 and Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that earlier versions of Windows assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The network resource connection should be remembered.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</para>
            <para>The operating system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when the <b>lpLocalName</b> member is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The type of local device and the type of network resource do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider, either because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The router or provider is busy, possibly initializing. The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified by the <b>lpLocalName</b> member is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<see cref="WNetUseConnection" /> function is similar to the
<b>WNetAddConnection3</b> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection3</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <para>For Microsoft network providers, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv4 address in dotted-decimal notation. An example for a share might be the following:</para>
      <para>
        <code>\192.168.1.1\share
</code>
      </para>
      <para>For Microsoft network providers on Windows Vista and later, the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter can contain an IPv6 address. However, the IPv6 literal format must be used so that the IPv6 address is parsed correctly. An IPv6 literal address is of the form:</para>
      <para>ipv6-address with the ':' characters replaced by '-' characters followed by the ".ipv6-literal.net" string.</para>
      <para>For example, for the following IPv6 address:</para>
      <para>
        <code>2001:4898:9:3:c069:aa97:fe76:2449
</code>
      </para>
      <para>an example for a share might be the following:</para>
      <para>
        <code>\2001-4898-9-3-c069-aa97-fe76-2449.ipv6-literal.net\share</code>
      </para>
      <para>Other network providers may support the <b>lpRemoteName</b> member of the <see cref="NETRESOURCE" /> structure pointed to by the <i>lpNetResource</i> parameter that contains an IPv4 or IPv6 address, but this is up to specific network provider.</para>
      <para>
        <b>Windows 7 and Windows Server 2008 R2:  </b>If the <b>WNetAddConnection3</b> function is called with explicit user credentials specified in the <i>pUsername</i> and <i>lpPassword</i> to establish a connection with a network resource on a specific server and then called again with either of these parameters as <b>NULL</b> (to use the default user name or default password) to the same server, the call with fail. The error returned will be <b>ERROR_BAD_USERNAME</b> or <b>ERROR_INVALID_PASSWORD</b>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection3 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso cref="WNetUseConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnectionA">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnectionW">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnection">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnectionA">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetAddConnectionW">
    <summary>
      <para>The
<b>WNetAddConnection</b> function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.
<b>Note</b>  This function is provided only for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetAddConnection2" /> or the
<see cref="WNetAddConnection3" /> function.</para>
    </summary>
    <param name="lpRemoteName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the network resource to connect to.</para>
    </param>
    <param name="lpPassword">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the password to be used to make a connection. This parameter is usually the password associated with the current user.</para>
      <para>If this parameter is <b>NULL</b>, the default password is used. If the string is empty, no password is used.</para>
      <para>
        <b>Windows Me/98/95:  </b>This parameter must be <b>NULL</b> or an empty string.</para>
    </param>
    <param name="lpLocalName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is <b>NULL</b>, a connection to the network resource is made without redirecting the local device.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The device specified in the <i>lpLocalName</i> parameter is already connected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The device type and the resource type do not match.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified in the <i>lpRemoteName</i> parameter is not valid or cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_ALREADY_REMEMBERED</b>
            </para>
          </description>
          <description>
            <para>An entry for the device specified in the <i>lpLocalName</i> parameter is already in the user profile.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation cannot be performed because a network component is not started or because a specified name cannot be used.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>On Windows Server 2003 and Windows XP, the WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID (a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. The call to the <b>GetLogicalDrives</b> function does not return network drive letters created by WNet function calls under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <para>On Windows Server 2003 and Windows XP, if a service that runs as LocalSystem calls the <b>WNetAddConnection</b> function, then the mapped drive is visible to all user logon sessions.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetAddConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2A">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2W">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2A">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection2W">
    <summary>
      <para>The
<b>WNetCancelConnection2</b> function cancels an existing network connection. You can also call the function to remove remembered network connections that are not currently connected.</para>
      <para>The
<b>WNetCancelConnection2</b> function supersedes the
<see cref="WNetCancelConnection" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>If  this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, all connections without devices are canceled.</para>
    </param>
    <param name="dwFlags">
      <para>Connection type. The following values are defined.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>The system does not update information about the connection.</para>
            <para>If the connection was marked as persistent in the registry, the system continues to restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>The system updates the user profile with the information that the connection is no longer a persistent one.</para>
            <para>The system will not restore this connection during subsequent logon operations. (Disconnecting resources using remote names has no effect on persistent connections.)</para>
          </description>
        </item>
      </list>
    </param>
    <param name="fForce">
      <para>Specifies whether the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to cancel a connection to a network resource with a call to the
<b>WNetCancelConnection2</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/canceling-a-network-connection">Canceling a Network Connection</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection2 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnectionA">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnectionW">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnection">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnectionA">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCancelConnectionW">
    <summary>
      <para>The
<b>WNetCancelConnection</b> function cancels an existing network connection.</para>
      <para>The
<b>WNetCancelConnection</b> function is provided for compatibility with 16-bit versions of Windows. Other Windows-based applications should call the
<see cref="WNetCancelConnection2" /> function.</para>
    </summary>
    <param name="lpName">
      <para>Pointer to a constant null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from.</para>
      <para>When this parameter specifies a redirected local device, the function cancels only the specified device redirection. If the parameter specifies a remote network resource, only the connections to remote networks without devices are canceled.</para>
    </param>
    <param name="fForce">
      <para>Specifies whether or not the disconnection should occur if there are open files or jobs on the connection. If this parameter is <b>FALSE</b>, the function fails if there are open files or jobs.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The user profile is in an incorrect format.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANNOT_OPEN_PROFILE</b>
            </para>
          </description>
          <description>
            <para>The system is unable to open the user profile to process persistent connections.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_DEVICE_IN_USE</b>
            </para>
          </description>
          <description>
            <para>The device is in use by an active process and cannot be disconnected.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>There are open files, and the <i>fForce</i> parameter is <b>FALSE</b>.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetCancelConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection" />
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetCloseEnum">
    <summary>
      <para>The
<b>WNetCloseEnum</b> function ends a network resource enumeration started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<b>WNetOpenEnum</b> function.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before the handle specified in the <i>hEnum</i> parameter is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The <i>hEnum</i> parameter does not specify a valid handle.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog">
    <summary>
      <para>The
<b>WNetConnectionDialog</b> function starts a general browsing dialog box for connecting to network resources. The function requires a handle to the owner window for the dialog box.</para>
    </summary>
    <param name="hwnd">
      <para>Handle to the owner window for the dialog box.</para>
    </param>
    <param name="dwType">
      <para>Resource type to allow connections to. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>Connections to disk resources.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the function returns –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the user clicks <b>OK</b> in the dialog box, the requested network connection will have been made when the
<b>WNetConnectionDialog</b> function returns.</para>
      <para>If the function attempts to make a connection and the network provider returns the message ERROR_INVALID_PASSWORD, the system prompts the user to enter a password. The system uses the new password in another attempt to make the connection.</para>
    </remarks>
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1A">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1W">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1A">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetConnectionDialog1W">
    <summary>
      <para>The
<b>WNetConnectionDialog1</b> function brings up a general browsing dialog for connecting to network resources. The function requires a
<see cref="CONNECTDLGSTRUCT" /> to establish the dialog box parameters.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>CONNECTDLGSTRUCT</b> structure. The structure establishes the browsing dialog parameters.</para>
    </param>
    <returns>
      <para>If the user cancels the dialog box, the function returns –1. If the function is successful, it returns NO_ERROR. Also, if the call is successful, the <b>dwDevNum</b> member of the
<b>CONNECTDLGSTRUCT</b> structure contains the number of the connected device.</para>
      <para>Typically this dialog returns an error only if the user cannot enter a dialog session. This is because errors that occur after a dialog session are reported to the user directly. If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Both the CONNDLG_RO_PATH and the CONNDLG_USE_MRU dialog box options are set. (Dialog box options are specified by the <b>dwFlags</b> member of the
<see cref="CONNECTDLGSTRUCT" /> structure.)</para>
            <para>-or-</para>
            <para>Both the CONNDLG_PERSIST and the CONNDLG_NOT_PERSIST dialog box options are set.</para>
            <para>-or-</para>
            <para>The CONNDLG_RO_PATH dialog box option is set and the <b>lpRemoteName</b> member of the
<see cref="NETRESOURCE" /> structure does not point to a remote network. (The
<b>CONNECTDLGSTRUCT</b> structure points to a
<b>NETRESOURCE</b> structure.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The <b>dwType</b> member of the
<b>NETRESOURCE</b> structure is not set to RESOURCETYPE_DISK.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to display the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetConnectionDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="CONNECTDLGSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog">
    <summary>
      <para>The
<b>WNetDisconnectDialog</b> function starts a general browsing dialog box for disconnecting from network resources. The function requires a handle to the owner window for the dialog box.</para>
    </summary>
    <param name="hwnd">
      <para>Handle to the owner window for the dialog box.</para>
    </param>
    <param name="dwType">
      <para>Resource type to disconnect from. This parameter can have the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>Disconnects from disk resources.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetDisconnectDialog</b> function returns immediately and creates a dialog box for disconnecting networked drives. This dialog box runs asynchronously on a worker thread.</para>
      <para>If the worker thread is terminated, the owner window and its associated dialog box are also terminated. If this occurs, the user might not be able to interact with the dialog box, because it will not  appear on the user's screen or will appear briefly.</para>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetCancelConnection2" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1A">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1W">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1A">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetDisconnectDialog1W">
    <summary>
      <para>The
<b>WNetDisconnectDialog1</b> function attempts to disconnect a network resource. If the underlying network returns ERROR_OPEN_FILES, the function prompts the user for confirmation. If there is any error, the function informs the user. The function requires a
<see cref="DISCDLGSTRUCT" /> to specify the parameters for the disconnect attempt.</para>
    </summary>
    <param name="lpConnDlgStruct">
      <para>Pointer to a
<b>DISCDLGSTRUCT</b> structure. The structure specifies the behavior for the disconnect attempt.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR. If the user cancels the dialog box, the return value is –1.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>When the system prompted the user for a decision about disconnecting, the user elected not to disconnect.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_OPEN_FILES</b>
            </para>
          </description>
          <description>
            <para>Unable to disconnect because the user is actively using the connection.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BUSY</b>
            </para>
          </description>
          <description>
            <para>The network provider is busy (possibly initializing). The caller should retry.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_ENOUGH_MEMORY</b>
            </para>
          </description>
          <description>
            <para>There is insufficient memory to start the dialog box.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetDisconnectDialog1 as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="DISCDLGSTRUCT" />
    <seealso cref="WNetConnectionDialog" />
    <seealso cref="WNetConnectionDialog1" />
    <seealso cref="WNetDisconnectDialog" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResource">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResourceA">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResourceW">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResource">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResourceA">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetEnumResourceW">
    <summary>
      <para>The
<b>WNetEnumResource</b> function continues an enumeration of network resources that was started by a call to the
<see cref="WNetOpenEnum" /> function.</para>
    </summary>
    <param name="hEnum">
      <para>Handle that identifies an enumeration instance. This handle must be returned by the
<see cref="WNetOpenEnum" /> function.</para>
    </param>
    <param name="lpcCount">
      <para>Pointer to a variable specifying the number of entries requested. If the number requested is –1, the function returns as many entries as possible.</para>
      <para>If the function succeeds, on return the variable pointed to by this parameter contains the number of entries actually read.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer that receives the enumeration results. The results are returned as an array of
<see cref="NETRESOURCE" /> structures. Note that the buffer you allocate must be large enough to hold the structures, plus the strings to which their members point. For more information, see the following Remarks section.</para>
      <para>The buffer is valid until the next call using the handle specified by the <i>hEnum</i> parameter. The order of
<b>NETRESOURCE</b> structures in the array is not predictable.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpBuffer</i> parameter, in bytes. If the buffer is too small to receive even one entry, this parameter receives the required size of the buffer.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>NO_ERROR</b>
            </para>
          </description>
          <description>
            <para>The enumeration succeeded, and the buffer contains the requested data. The calling application can continue to call
<b>WNetEnumResource</b> to complete the enumeration.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>There are no more entries. The buffer contents are undefined.</para>
          </description>
        </item>
      </list>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_HANDLE</b>
            </para>
          </description>
          <description>
            <para>The handle specified by the <i>hEnum</i> parameter is not valid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable. (This condition is tested before <i>hEnum</i> is tested for validity.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetEnumResource</b> function does not enumerate users connected to a share; you can call the
<see cref="NetConnectionEnum" /> function to accomplish this task. To enumerate hidden shares, call the
<see cref="NetShareEnum" /> function.</para>
      <para>An application cannot set the <i>lpBuffer</i> parameter to <b>NULL</b> and retrieve the required buffer size from the <i>lpBufferSize</i> parameter. Instead, the application should allocate a buffer of a reasonable size—16 kilobytes is typical—and use the value of <i>lpBufferSize</i> for error detection.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetEnumResource as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnection">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnectionA">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnectionW">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnection">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnectionA">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetConnectionW">
    <summary>
      <para>The
<b>WNetGetConnection</b> function retrieves the name of the network resource associated with a local device.</para>
    </summary>
    <param name="lpLocalName">
      <para>Pointer to a constant null-terminated string that specifies the name of the local device to get the network name for.</para>
    </param>
    <param name="lpRemoteName">
      <para>Pointer to a null-terminated  string  that receives the remote name used to make the connection.</para>
    </param>
    <param name="lpnLength">
      <para>Pointer to a variable that specifies the size of the buffer pointed to by the <i>lpRemoteName</i> parameter, in characters. If the function fails because the buffer is not large enough, this parameter returns the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalName</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by <i>lpLocalName</i> is not a redirected device. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small. The <i>lpnLength</i> parameter points to a variable that contains the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>The device is not currently connected, but it is a persistent connection. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the network connection was made using the Microsoft LAN Manager network, and the calling application is running in a different logon session than the application that made the connection, a call to the
<b>WNetGetConnection</b> function for the associated local device will fail. The function fails with ERROR_NOT_CONNECTED or ERROR_CONNECTION_UNAVAIL. This is because a connection made using Microsoft LAN Manager is visible only to applications running in the same logon session as the application that made the connection. (To prevent the call to
<b>WNetGetConnection</b> from failing it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>For a code sample that illustrates how to use the
<b>WNetGetConnection</b> function to retrieve the name of the network resource associated with a local device, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-connection-name">Retrieving the Connection Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetUser" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastError">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastErrorA">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastErrorW">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastError">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastErrorA">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetLastErrorW">
    <summary>
      <para>The
<b>WNetGetLastError</b> function retrieves the most recent extended error code set by a WNet function. The network provider reported this error code; it will not generally be one of the errors included in the SDK header file WinError.h.</para>
    </summary>
    <param name="lpError">
      <para>Pointer to a variable that receives the error code reported by the network provider. The error code is specific to the network provider.</para>
    </param>
    <param name="lpErrorBuf">
      <para>Pointer to the buffer that receives the null-terminated string describing the error.</para>
    </param>
    <param name="nErrorBufSize">
      <para>Size of the buffer pointed to by the <i>lpErrorBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended.</para>
    </param>
    <param name="lpNameBuf">
      <para>Pointer to the buffer that receives the null-terminated string identifying the network provider that raised the error.</para>
    </param>
    <param name="nNameBufSize">
      <para>Size of the buffer pointed to by the <i>lpNameBuf</i> parameter, in characters. If the buffer is too small for the error string, the string is truncated but still null-terminated.</para>
    </param>
    <returns>
      <para>If the function succeeds, and it obtains the last error that the network provider reported, the return value is NO_ERROR.</para>
      <para>If the caller supplies an invalid buffer, the return value is ERROR_INVALID_ADDRESS.</para>
    </returns>
    <remarks>
      <para>The
<b>WNetGetLastError</b> function retrieves errors that are specific to a network provider. You can call
<b>WNetGetLastError</b> when a WNet function returns ERROR_EXTENDED_ERROR.</para>
      <para>Like the
<see cref="GetLastError" /> function,
<b>WNetGetLastError</b> returns extended error information, which is maintained on a per-thread basis. Unlike <b>GetLastError</b>, the
<b>WNetGetLastError</b> function can return a string for reporting errors that are not described by any existing error code in WinError.h.</para>
      <para>For more information about using an application-defined error handler that calls the
<b>WNetGetLastError</b> function, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-network-errors">Retrieving Network Errors</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetLastError as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformation">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformationA">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformationW">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformation">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformationA">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetNetworkInformationW">
    <summary>
      <para>The
<b>WNetGetNetworkInformation</b> function returns extended information about a specific network provider whose name was returned by a previous network enumeration.</para>
    </summary>
    <param name="lpProvider">
      <para>Pointer to a constant null-terminated string that contains the name of the network provider for which information is required.</para>
    </param>
    <param name="lpNetInfoStruct">
      <para>Pointer to a
<see cref="NETINFOSTRUCT" /> structure. The structure describes characteristics of the network.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProvider</i> parameter does not match any running network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_VALUE</b>
            </para>
          </description>
          <description>
            <para>The <b>cbStructure</b> member of the
<b>NETINFOSTRUCT</b> structure does not contain a valid structure size.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetNetworkInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETINFOSTRUCT" />
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetEnumResource" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetOpenEnum" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderName">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderNameA">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderNameW">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderName">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderNameA">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetProviderNameW">
    <summary>
      <para>The
<b>WNetGetProviderName</b> function obtains the provider name for a specific type of network.</para>
    </summary>
    <param name="dwNetType">
      <para>Network type that is unique to the network. If two networks claim the same type, the function returns the name of the provider loaded first. Only the high word of the network type is used. If a network reports a subtype in the low word, it is ignored.</para>
      <para>You can find a complete list of network types in the header file Winnetwk.h.</para>
    </param>
    <param name="lpProviderName">
      <para>Pointer to a buffer that receives the network provider name.</para>
    </param>
    <param name="lpBufferSize">
      <para>Size of the buffer passed to the function, in characters. If the return value is ERROR_MORE_DATA, <i>lpBufferSize</i> returns the buffer size required (in characters) to hold the provider name.</para>
      <para>
        <b>Windows Me/98/95:  </b>The size of the buffer is in bytes, not characters. Also, the buffer must be at least 1 byte long.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer is too small to hold the network provider name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The <i>lpProviderName</i> parameter or the <i>lpBufferSize</i> parameter is invalid.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetProviderName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformation">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformationA">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformationW">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformation">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformationA">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceInformationW">
    <summary>
      <para>When provided with a remote path to a network resource, the
<b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with the
<see cref="WNetGetResourceParent" /> function to parse and interpret a network path typed in by a user.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which information is required.</para>
      <para>The <b>lpRemoteName</b> member of the structure should specify the remote path name of the resource, typically one typed in by a user. The <b>lpProvider</b> and <b>dwType</b> members should also be filled in if known, because this operation can be memory intensive, especially if you do not specify the <b>dwType</b> member. If you do not know the values for these members, you should set them to <b>NULL</b>. All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to the buffer to receive the result. On successful return, the first portion of the buffer is a
<see cref="NETRESOURCE" /> structure representing that portion of the input resource path that is accessed through the WNet functions, rather than through system functions specific to the input resource type. (The remainder of the buffer contains the variable-length strings to which the members of the
<b>NETRESOURCE</b> structure point.)</para>
      <para>For example, if the input remote resource path is \server\share\dir1\dir2, then the output
<b>NETRESOURCE</b> structure contains information about the resource \server\share. The \dir1\dir2 portion of the path is accessed through the
<a href="https://docs.microsoft.com//windows/desktop/FileIO/file-management-functions">file management functions</a>. The <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of
<b>NETRESOURCE</b> are returned, with all other members set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member is returned in the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. This allows the caller to perform a string comparison to determine whether the resource passed to
<b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to
<b>WNetEnumResource</b>.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. The buffer you allocate must be large enough to hold the
<b>NETRESOURCE</b> structure, plus the strings to which its members point. If the buffer is too small for the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <param name="lplpSystem">
      <para>If the function returns successfully, this parameter points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. (This applies only to functions specific to the resource type rather than the WNet functions.)</para>
      <para>For example, if the input remote resource name is \server\share\dir1\dir2, the <b>lpRemoteName</b> member of the output
<see cref="NETRESOURCE" /> structure points to \server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEV_TYPE</b>
            </para>
          </description>
          <description>
            <para>The input <b>dwType</b> member does not match the type of resource specified by the <b>lpRemoteName</b> member.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Call
<see cref="WNetGetLastError" /> to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceInformation as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceParent" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParent">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParentA">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParentW">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParent">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParentA">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetResourceParentW">
    <summary>
      <para>The
<b>WNetGetResourceParent</b> function returns the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource.</para>
      <para>Call the
<see cref="WNetGetResourceInformation" /> and
<b>WNetGetResourceParent</b> functions to move up the network hierarchy. Call the
<see cref="WNetOpenEnum" /> function to move down the hierarchy.</para>
    </summary>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the network resource for which the parent name is required.</para>
      <para>Specify the members of the input
<b>NETRESOURCE</b> structure as follows. The caller typically knows the values to provide for the <b>lpProvider</b> and <b>dwType</b> members after previous calls to
<b>WNetGetResourceInformation</b> or
<b>WNetGetResourceParent</b>.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>This member should be filled in if known; otherwise, it should be set to <b>NULL</b>.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>This member should specify the remote name of the network resource whose parent is required.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>This member should specify the network provider that owns the resource. This member is required; otherwise, the function could produce incorrect results.</para>
          </description>
        </item>
      </list>
      <para>All other members of the
<b>NETRESOURCE</b> structure are ignored.</para>
    </param>
    <param name="lpBuffer">
      <para>Pointer to a buffer to receive a single
<b>NETRESOURCE</b> structure that represents the parent resource. The function returns the <b>lpRemoteName</b>, <b>lpProvider</b>, <b>dwType</b>, <b>dwDisplayType</b>, and <b>dwUsage</b> members of the structure; all other members are set to <b>NULL</b>.</para>
      <para>The <b>lpRemoteName</b> member points to the remote name for the parent resource. This name uses the same syntax as the one returned from an enumeration by the
<see cref="WNetEnumResource" /> function. The caller can perform a string comparison to determine whether the
<b>WNetGetResourceParent</b> resource is the same as that returned by
<b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <b>lpRemoteName</b> member is returned as <b>NULL</b>.</para>
      <para>The presence of the RESOURCEUSAGE_CONNECTABLE bit in the <b>dwUsage</b> member indicates that you can connect to the parent resource, but only when it is available on the network.</para>
    </param>
    <param name="lpcbBuffer">
      <para>Pointer to a location that, on entry, specifies the size of the <i>lpBuffer</i> buffer, in bytes. If the buffer is too small to hold the result, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpRemoteName</b> member is not an existing network resource for any network.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The input <b>lpProvider</b> member does not match any installed network provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_AUTHENTICATED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have the necessary permissions to obtain the name of the parent.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The
<b>WNetGetResourceParent</b> function is typically used in conjunction with the
<see cref="WNetGetResourceInformation" /> function to parse and interpret a network path typed in by a user.</para>
      <para>Unlike the
<b>WNetGetResourceInformation</b> function, if the resource includes a parent in its syntax, the
<b>WNetGetResourceParent</b> function returns the parent, whether or not the resource actually exists.
<b>WNetGetResourceParent</b> should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of this type of application. Note that no assumptions should be made about the type of resource that will be returned.</para>
      <para>You can call the
<see cref="WNetEnumResource" />,
<see cref="WNetGetResourceInformation" />, or
<b>WNetGetResourceParent</b> function to return information from the
<see cref="NETRESOURCE" /> structure. You can also construct network resource information using the members of the
<b>NETRESOURCE</b> structure.</para>
      <para>An example of an inappropriate use of
<b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy. The function will return incorrect results for other networks.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetResourceParent as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetGetNetworkInformation" />
    <seealso cref="WNetGetProviderName" />
    <seealso cref="WNetGetResourceInformation" />
    <seealso cref="WNetGetUniversalName" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalName">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalNameA">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalNameW">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalName">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalNameA">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUniversalNameW">
    <summary>
      <para>The
<b>WNetGetUniversalName</b> function takes a drive-based path for a network resource and returns an information structure that contains a more universal form of the name.</para>
    </summary>
    <param name="lpLocalPath">
      <para>A pointer to a constant null-terminated string that is a drive-based path for a network resource.</para>
      <para>For example, if drive H has been mapped to a network drive share, and the network       resource of interest is a file named Sample.doc in the directory \Win32\Examples on that share, the drive-based path is H:\Win32\Examples\Sample.doc.</para>
    </param>
    <param name="dwInfoLevel">
      <para>The type of structure that the function stores in the buffer pointed to by the <i>lpBuffer</i> parameter. This parameter can be one of the following values defined in the <i>Winnetwk.h</i> header file.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>UNIVERSAL_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="UNIVERSAL_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
        <item>
          <description>
            <b>REMOTE_NAME_INFO_LEVEL</b>
          </description>
          <description>
            <para>The function stores a
<see cref="REMOTE_NAME_INFO" /> structure in the buffer.</para>
          </description>
        </item>
      </list>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure points to a Universal Naming Convention (UNC) name string.</para>
      <para>The
<see cref="REMOTE_NAME_INFO" /> structure points to a UNC name string and two additional connection information strings. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpBuffer">
      <para>A pointer to a buffer that receives the structure specified by the <i>dwInfoLevel</i> parameter.</para>
    </param>
    <param name="lpBufferSize">
      <para>A pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the <i>lpBuffer</i> parameter.</para>
      <para>If the function succeeds, it sets the variable pointed to by <i>lpBufferSize</i> to the number of bytes stored in the buffer. If the function fails because the buffer is too small, this location receives the required buffer size, and the function returns ERROR_MORE_DATA.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The string pointed to by the <i>lpLocalPath</i> parameter is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CONNECTION_UNAVAIL</b>
            </para>
          </description>
          <description>
            <para>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. Use the
<see cref="WNetGetLastError" /> function to obtain a description of the error.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The buffer pointed to by the <i>lpBuffer</i> parameter is too small. The function sets the variable pointed to by the <i>lpBufferSize</i> parameter to the required buffer size. More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_SUPPORTED</b>
            </para>
          </description>
          <description>
            <para>The <i>dwInfoLevel</i> parameter is set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC names. (None of the network providers support this function.)</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the network providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpLocalPath</i> parameter is not redirected.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</para>
      <para>The
<b>WNetGetUniversalName</b> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</para>
      <code>\\servername\sharename\path\file

</code>
      <para>Using the example from the preceding description of the <i>lpLocalPath</i> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\Win32\Examples\Sample.doc would be the following:</para>
      <code>\\coolserver\hotshare\win32\examples\sample.doc

</code>
      <para>The
<see cref="UNIVERSAL_NAME_INFO" /> structure contains a pointer to a UNC name string. The
<see cref="REMOTE_NAME_INFO" /> structure also contains a pointer to a UNC name string as well as pointers to two other useful strings. For example, a process can pass the
<b>REMOTE_NAME_INFO</b> structure's <b>lpszConnectionInfo</b> member to the
<see cref="WNetAddConnection2" /> function to connect a local device to the network resource. Then the process can append the string pointed to by the <b>lpszRemainingPath</b> member to the local device string. The resulting string can be passed to functions that require a drive-based path.</para>
      <para>The <i>lpLocalPath</i> parameter does not have to specify a path or resource that is already present on a remote resource.  For example, the <i>lpLocalPath</i> parameter could specify and folder, a hierarchy of folders, or a file that does not currently exist. The
<b>WNetGetUniversalName</b> function returns a more universal form of the name in these cases.</para>
      <para>The size of the buffer pointed to by the <i>lpBuffer</i> parameter and specified in the <i>lpBufferSize</i> parameter must be much larger than the size of the <see cref="REMOTE_NAME_INFO" /></para>
      <para>or <see cref="UNIVERSAL_NAME_INFO" /> structures. The buffer pointed to by the <i>lpBuffer</i> parameter must be large enough to store the UNC strings pointed to by the members in the <b>REMOTE_NAME_INFO</b></para>
      <para>or <b>UNIVERSAL_NAME_INFO</b> structures. If the buffer size is too small, then the function fails with ERROR_MORE_DATA and the variable pointed to by the <i>lpBufferSize</i> parameter indicates the required buffer size.</para>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>This function queries the MS-DOS device namespaces associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUniversalName</b> function to retrieve the universal UNC name strings associated with drive-based path for a network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR Buffer[1024];
    DWORD dwBufferLength = 1024;

    UNIVERSAL_NAME_INFO * unameinfo;
    REMOTE_NAME_INFO *remotenameinfo;

    wprintf(L"Calling WNetGetUniversalName with Local Path = %s\n", argv[1]);

    unameinfo = (UNIVERSAL_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], UNIVERSAL_NAME_INFO_LEVEL, (LPVOID) unameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", unameinfo-&gt;lpUniversalName);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=UNIVERSAL_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }


    remotenameinfo = (REMOTE_NAME_INFO *) &amp;amp;amp;amp;amp;amp;Buffer;
    dwRetVal = WNetGetUniversalName(argv[1], REMOTE_NAME_INFO_LEVEL,
        (LPVOID) remotenameinfo, &amp;amp;amp;amp;amp;amp;dwBufferLength );
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUniversalName returned success for InfoLevel=REMOTE_NAME_INFO_LEVEL\n");
        wprintf(L"\tUniversal name = %s\n", remotenameinfo-&gt;lpUniversalName);
        wprintf(L"\tConnection name = %s\n", remotenameinfo-&gt;lpConnectionName);
        wprintf(L"\tRemaining path = %s\n", remotenameinfo-&gt;lpRemainingPath);
    }

    else {
        wprintf(L"WNetGetUser failed for InfoLevel=REMOTE_NAME_INFO_LEVEL with error: %u\n", dwRetVal);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUniversalName as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/determining-the-location-of-a-share">Determining the Location of a Share</seealso>
    <seealso cref="REMOTE_NAME_INFO" />
    <seealso cref="UNIVERSAL_NAME_INFO" />
    <seealso cref="WNetAddConnection2" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUser">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUserA">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUserW">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUser">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUserA">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetGetUserW">
    <summary>
      <para>The
<b>WNetGetUser</b> function retrieves the current default user name, or the user name used to establish a network connection.</para>
    </summary>
    <param name="lpName">
      <para>A pointer to a constant <b>null</b>-terminated string that specifies either the name of a local device that has been redirected to a network resource, or the remote name of a network resource to which a connection has been made without redirecting a local device.</para>
      <para>If this parameter is <b>NULL</b> or the empty string, the system returns the name of the current user for the process.</para>
    </param>
    <param name="lpUserName">
      <para>A pointer to a buffer that receives the <b>null</b>-terminated user name.</para>
    </param>
    <param name="lpnLength">
      <para>A pointer to a variable that specifies the size of the <i>lpUserName</i> buffer, in characters. If the call fails because the buffer is not large enough, this variable contains the required buffer size.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONNECTED</b>
            </para>
          </description>
          <description>
            <para>The device specified by the <i>lpName</i> parameter is not a redirected device or a connected network name.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>More entries are available with subsequent calls.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>None of the providers recognize the local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>The <b>WNetGetUser</b> function is not aware of shares on the Distributed File System (DFS). If the name specified by the <i>lpName</i> parameter is a local device  redirected to a DFS share or a remote resource that represents a DFS share, the <b>WNetGetUser</b> function fails with ERROR_NOT_CONNECTED.</para>
      <h4>Examples</h4>
      <para>The following code sample illustrates how to use the
<b>WNetGetUser</b> function to retrieve the name of the user associated with a redirected local device or a remote network resource.</para>
      <code>#ifndef UNICODE
#define UNICODE
#endif
#pragma comment(lib, "mpr.lib")

#include &lt;windows.h&gt;
#include &lt;tchar.h&gt;
#include &lt;stdio.h&gt;
#include &lt;Winnetwk.h&gt;

int wmain(int argc, wchar_t * argv[])
{
    DWORD dwRetVal;

    WCHAR UserName[MAX_PATH];

    DWORD dwNameLength = MAX_PATH;

    if (argc != 2) {
        wprintf
            (L"Usage: %s [Redirected-LocalDevice or Network-Resource-Remote-name\n",
             argv[0]);
        exit(1);
    }

    wprintf(L"Calling WNetGetUser with Network-Resource = %s\n", argv[1]);

    dwRetVal = WNetGetUser(argv[1], UserName, &amp;amp;amp;amp;amp;amp;dwNameLength);
    //
    // If the call succeeds, print the user information.
    //
    if (dwRetVal == NO_ERROR) {

        wprintf(L"WNetGetUser returned success\n");
        wprintf(L"\tUsername=%s   NameLength=%d\n", &amp;amp;amp;amp;amp;amp;UserName, dwNameLength);
        exit(0);
    }

    else {
        wprintf(L"WNetGetUser failed with error: %u\n", dwRetVal);
        exit(1);
    }
}


</code>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetGetUser as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/retrieving-the-user-name">Retrieving the User Name</seealso>
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnum">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnumA">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnumW">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnum">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnumA">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetOpenEnumW">
    <summary>
      <para>The
<b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the
<see cref="WNetEnumResource" /> function.</para>
    </summary>
    <param name="dwScope">
      <para>Scope of the enumeration. This parameter can be one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCE_CONNECTED</b>
          </description>
          <description>
            <para>Enumerate all currently connected resources. The function ignores the <i>dwUsage</i> parameter. For more information, see the following Remarks section.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_CONTEXT</b>
          </description>
          <description>
            <para>Enumerate only resources in the network context of the caller. Specify this value for a Network Neighborhood view. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_GLOBALNET</b>
          </description>
          <description>
            <para>Enumerate all resources on the network.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCE_REMEMBERED</b>
          </description>
          <description>
            <para>Enumerate all remembered (persistent) connections. The function ignores the <i>dwUsage</i> parameter.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="dwType">
      <para>Resource types to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>RESOURCETYPE_ANY</b>
          </description>
          <description>
            <para>All resources. This value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_DISK</b>
          </description>
          <description>
            <para>All disk resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCETYPE_PRINT</b>
          </description>
          <description>
            <para>All print resources.</para>
          </description>
        </item>
      </list>
      <para>If a network provider cannot distinguish between print and disk resources, it can enumerate all resources.</para>
    </param>
    <param name="dwUsage">
      <para>Resource usage type to be enumerated. This parameter can be a combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>0</b>
          </description>
          <description>
            <para>All resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONNECTABLE</b>
          </description>
          <description>
            <para>All connectable resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_CONTAINER</b>
          </description>
          <description>
            <para>All container resources.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ATTACHED</b>
          </description>
          <description>
            <para>Setting this value forces
<b>WNetOpenEnum</b> to fail if the user is not authenticated. The function fails even if the network allows enumeration without authentication.</para>
          </description>
        </item>
        <item>
          <description>
            <b>RESOURCEUSAGE_ALL</b>
          </description>
          <description>
            <para>Setting this value is equivalent to setting RESOURCEUSAGE_CONNECTABLE, RESOURCEUSAGE_CONTAINER, and RESOURCEUSAGE_ATTACHED.</para>
          </description>
        </item>
      </list>
      <para>This parameter is ignored unless the <i>dwScope</i> parameter is equal to RESOURCE_GLOBALNET. For more information, see the following Remarks section.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies the container to enumerate. If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be <b>NULL</b>.</para>
      <para>If this parameter is <b>NULL</b>, the root of the network is assumed. (The system organizes a network as a hierarchy; the root is the topmost container in the network.)</para>
      <para>If this parameter is not <b>NULL</b>, it must point to a
<b>NETRESOURCE</b> structure. This structure can be filled in by the application or it can be returned by a call to the
<see cref="WNetEnumResource" /> function. The
<b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <i>dwUsage</i> parameter.</para>
      <para>To enumerate all network resources, an application can begin the enumeration by calling
<b>WNetOpenEnum</b> with the <i>lpNetResource</i> parameter set to <b>NULL</b>, and then use the returned handle to call
<b>WNetEnumResource</b> to enumerate resources. If one of the resources in the
<b>NETRESOURCE</b> array returned by the
<b>WNetEnumResource</b> function is a container resource, you can call
<b>WNetOpenEnum</b> to open the resource for further enumeration.</para>
    </param>
    <param name="lphEnum">
      <para>Pointer to an enumeration handle that can be used in a subsequent call to
<see cref="WNetEnumResource" />.</para>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_NOT_CONTAINER</b>
            </para>
          </description>
          <description>
            <para>The <i>lpNetResource</i> parameter does not point to a container.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>Either the <i>dwScope</i> or the <i>dwType</i> parameter is invalid, or there is an invalid combination of parameters.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>A remote network resource name supplied in the <b>NETRESOURCE</b> structure resolved to an invalid network address.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>If the <i>dwScope</i> parameter is equal to RESOURCE_CONNECTED, a network connection made using the Microsoft LAN Manager network is omitted from the enumeration if the connection was made by an application running in a different logon session than the application calling the
<b>WNetOpenEnum</b> function. This is because connections made using Microsoft LAN Manager are visible only to applications running in the same logon session as the application that made the connection. (To include the connection in the enumeration, it is not sufficient for the application to be running in the user account that created the connection.)</para>
      <para>The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</para>
      <para>The
<b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell NetWare network and identify the containers.</para>
      <code>LanMan (container, in this case the provider)
  ACCOUNTING (container, in this case the domain)
    \\ACCTSPAY (container, in this case the server)
      PAYFILES (disk)
      LASERJET (print)

NetWare (container, in this case the provider)
  MARKETING (container, in this case the server)
    SYS (disk, first one on any NetWare server)
    ANOTHERVOLUME (disk)
    LASERJET (print)

</code>
      <h4>Examples</h4>
      <para>For a code sample that illustrates an application-defined function that enumerates all the resources on a network, see
<a href="https://docs.microsoft.com//windows/desktop/WNet/enumerating-network-resources">Enumerating Network Resources</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetOpenEnum as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="NETRESOURCE" />
    <seealso cref="WNetCloseEnum" />
    <seealso cref="WNetEnumResource" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
  </member>
  <member name="Windows.WNetUseConnection">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
  <member name="Windows.WNetUseConnectionA">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
  <member name="Windows.WNetUseConnectionW">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
  <member name="Windows.WNetUseConnection">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
  <member name="Windows.WNetUseConnectionA">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
  <member name="Windows.WNetUseConnectionW">
    <summary>
      <para>The
<b>WNetUseConnection</b> function makes a connection to a network resource. The function can redirect a local device to a network resource.</para>
      <para>The
<b>WNetUseConnection</b> function is similar to the
<see cref="WNetAddConnection3" /> function. The main difference is that
<b>WNetUseConnection</b> can automatically select an unused local device to redirect to the network resource.</para>
    </summary>
    <param name="hwndOwner">
      <para>Handle to a window that the provider of network resources can use as an owner window for dialog boxes. Use this parameter if you set the CONNECT_INTERACTIVE value in the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpNetResource">
      <para>Pointer to a
<see cref="NETRESOURCE" /> structure that specifies details of the proposed connection. The structure contains information about the network resource, the local device, and the network resource provider.</para>
      <para>You must specify the following members of the
<b>NETRESOURCE</b> structure.</para>
      <list type="table">
        <listheader>
          <description>Member</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>
              <b>dwType</b>
            </b>
          </description>
          <description>
            <para>Specifies the type of resource to connect to.</para>
            <para>It is most efficient to specify a resource type in this member, such as RESOURCETYPE_DISK or RESOURCETYPE_PRINT. However, if the <b>lpLocalName</b> member is <b>NULL</b>, or if it points to an empty string and CONNECT_REDIRECT is not set, <b>dwType</b> can be RESOURCETYPE_ANY.</para>
            <para>This method works only if the function does not automatically choose a device to redirect to the network resource.</para>
            <para>Although this member is required, its information may be ignored by the network service provider.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpLocalName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner.</para>
            <para>If the string is empty, or if <b>lpLocalName</b> is <b>NULL</b>, a connection to the network occurs without redirection.</para>
            <para>If the CONNECT_REDIRECT value is set in the <i>dwFlags</i> parameter, or if the network requires a redirected local device, the function chooses a local device to redirect and returns the name of the device in the <i>lpAccessName</i> parameter.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpRemoteName</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length, and it must follow the network provider's naming conventions.</para>
          </description>
        </item>
        <item>
          <description>
            <b>
              <b>lpProvider</b>
            </b>
          </description>
          <description>
            <para>Pointer to a <b>null</b>-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is <b>NULL</b>, or if it points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by the <b>lpRemoteName</b> member.</para>
            <para>If this member is not <b>NULL</b>, the operating system attempts to make a connection only to the named network provider.</para>
            <para>You should set this member only if you know the network provider you want to use. Otherwise, let the operating system determine which provider the network name maps to.</para>
          </description>
        </item>
      </list>
      <para>The
<b>WNetUseConnection</b> function ignores the other members of the
<see cref="NETRESOURCE" /> structure. For more information, see the descriptions following for the <i>dwFlags</i> parameter.</para>
    </param>
    <param name="lpPassword">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a password to be used in making the network connection.</para>
      <para>If <i>lpPassword</i> is <b>NULL</b>, the function uses the current default password associated with the user specified by <i>lpUserID</i>.</para>
      <para>If <i>lpPassword</i> points to an empty string, the function does not use a password.</para>
      <para>If the connection fails because of an invalid password and the CONNECT_INTERACTIVE value is set in the <i>dwFlags</i> parameter, the function displays a dialog box asking the user to type the password.</para>
    </param>
    <param name="lpUserId">
      <para>Pointer to a constant <b>null</b>-terminated string that specifies a user name for making the connection.</para>
      <para>If <i>lpUserID</i> is <b>NULL</b>, the function uses the default user name. (The user context for the process provides the default user name.)</para>
      <para>The <i>lpUserID</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account.</para>
      <para>The user-name string represents a
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/s-gly">security context</a>. It may be specific to a network provider.</para>
    </param>
    <param name="dwFlags">
      <para>Set of bit flags describing the connection. This parameter can be any combination of the following values.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_INTERACTIVE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system may interact with the user for authentication purposes.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_PROMPT</b>
          </description>
          <description>
            <para>This flag instructs the system not to use any default settings for user names or passwords without offering the user the opportunity to supply an alternative. This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_REDIRECT</b>
          </description>
          <description>
            <para>This flag forces the redirection of a local device when making the connection.</para>
            <para>If the <b>lpLocalName</b> member of
<see cref="NETRESOURCE" /> specifies a local device to redirect, this flag has no effect, because the operating system still attempts to redirect the specified device. When the operating system automatically chooses a local device, the <b>dwType</b> member must not be equal to RESOURCETYPE_ANY.</para>
            <para>If this flag is not set, a local device is automatically chosen for redirection only if the network requires a local device to be redirected.</para>
            <para>
              <b>Windows XP:  </b>When the system automatically assigns network drive letters, letters are assigned beginning with Z:, then Y:, and ending with C:. This reduces collision between per-logon drive letters (such as network drive letters) and global drive letters (such as disk drives). Note that previous releases assigned drive letters beginning with C: and ending with Z:.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_UPDATE_PROFILE</b>
          </description>
          <description>
            <para>This flag instructs the operating system to store the network resource connection.</para>
            <para>If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on. The system remembers only successful connections that redirect local devices. It does not remember connections that are unsuccessful or deviceless connections. (A deviceless connection occurs when <b>lpLocalName</b> is <b>NULL</b> or when it points to an empty string.)</para>
            <para>If this bit flag is clear, the operating system does not automatically restore the connection at logon.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_COMMANDLINE</b>
          </description>
          <description>
            <para>If this flag is set, the operating system prompts the user for authentication using the command line instead of a graphical user interface (GUI). This flag is ignored unless CONNECT_INTERACTIVE is also set.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
        <item>
          <description>
            <b>CONNECT_CMD_SAVECRED</b>
          </description>
          <description>
            <para>If this flag is set, and the operating system prompts for a credential, the credential should be saved by the credential manager. If the credential manager is disabled for the caller's logon session, or if the network provider does not support saving credentials, this flag is ignored. This flag is also ignored unless you set the CONNECT_COMMANDLINE flag.</para>
            <para>
              <b>Windows 2000/NT and Windows Me/98/95:  </b>This value is not supported.</para>
          </description>
        </item>
      </list>
    </param>
    <param name="lpAccessName">
      <para>Pointer to a buffer that receives system requests on the connection. This parameter can be <b>NULL</b>.</para>
      <para>If this parameter is specified, and the <b>lpLocalName</b> member of the
<b>NETRESOURCE</b> structure specifies a local device, this buffer receives the local device name. If <b>lpLocalName</b> does not specify a device and the network requires a local device redirection, or if the CONNECT_REDIRECT value is set, this buffer receives the name of the redirected local device.</para>
      <para>Otherwise, the name copied into the buffer is that of a remote resource. If specified, this buffer must be at least as large as the string pointed to by the <b>lpRemoteName</b> member.</para>
    </param>
    <param name="lpBufferSize">
      <para>Pointer to a variable that specifies the size of the <i>lpAccessName</i> buffer, in characters. If the call fails because the buffer is not large enough, the function returns the required buffer size in this location. For more information, see the descriptions of the <i>lpAccessName</i> parameter and the ERROR_MORE_DATA error code in the Return Values section.</para>
    </param>
    <param name="lpResult">
      <para>Pointer to a variable that receives additional information about the connection. This parameter can be the following value.</para>
      <list type="table">
        <listheader>
          <description>Value</description>
          <description>Meaning</description>
        </listheader>
        <item>
          <description>
            <b>CONNECT_LOCALDRIVE</b>
          </description>
          <description>
            <para>If this flag is set, the connection was made using a local device redirection. If the <i>lpAccessName</i> parameter points to a buffer, the local device name is copied to the buffer.</para>
          </description>
        </item>
      </list>
    </param>
    <returns>
      <para>If the function succeeds, the return value is NO_ERROR.</para>
      <para>If the function fails, the return value is a
<a href="https://docs.microsoft.com//windows/desktop/Debug/system-error-codes">system error code</a>, such as one of the following values.</para>
      <list type="table">
        <listheader>
          <description>Return code</description>
          <description>Description</description>
        </listheader>
        <item>
          <description>
            <para>
              <b>ERROR_ACCESS_DENIED</b>
            </para>
          </description>
          <description>
            <para>The caller does not have access to the network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_ALREADY_ASSIGNED</b>
            </para>
          </description>
          <description>
            <para>The local device specified by the <b>lpLocalName</b> member is already connected to a network resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_DEVICE</b>
            </para>
          </description>
          <description>
            <para>The value specified by <b>lpLocalName</b> is invalid.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_NET_NAME</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpRemoteName</b> member is not acceptable to any network resource provider because the resource name is invalid, or because the named resource cannot be located.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_BAD_PROVIDER</b>
            </para>
          </description>
          <description>
            <para>The value specified by the <b>lpProvider</b> member does not match any provider.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_CANCELLED</b>
            </para>
          </description>
          <description>
            <para>The attempt to make the connection was canceled by the user through a dialog box from one of the network resource providers, or by a called resource.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_EXTENDED_ERROR</b>
            </para>
          </description>
          <description>
            <para>A network-specific error occurred. To obtain a description of the error, call the
<see cref="WNetGetLastError" /> function.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_ADDRESS</b>
            </para>
          </description>
          <description>
            <para>The caller passed in a pointer to a buffer that could not be accessed.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PARAMETER</b>
            </para>
          </description>
          <description>
            <para>This error is a result of one of the following conditions:</para>
            <list type="number">
              <item>
                <description>The <b>lpRemoteName</b> member is <b>NULL</b>. In addition, <i>lpAccessName</i> is not <b>NULL</b>, but <i>lpBufferSize</i> is either <b>NULL</b> or points to zero.</description>
              </item>
              <item>
                <description>The <b>dwType</b> member is neither RESOURCETYPE_DISK nor RESOURCETYPE_PRINT. In addition, either CONNECT_REDIRECT is set in <i>dwFlags</i> and <b>lpLocalName</b> is <b>NULL</b>, or the connection is to a network that requires the redirecting of a local device.</description>
              </item>
            </list>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_INVALID_PASSWORD</b>
            </para>
          </description>
          <description>
            <para>The specified password is invalid and the CONNECT_INTERACTIVE flag is not set.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_MORE_DATA</b>
            </para>
          </description>
          <description>
            <para>The <i>lpAccessName</i> buffer is too small.</para>
            <para>If a local device is redirected, the buffer needs to be large enough to contain the local device name. Otherwise, the buffer needs to be large enough to contain either the string pointed to by <b>lpRemoteName</b>, or the name of the connectable resource whose alias is pointed to by <b>lpRemoteName</b>. If this error is returned, then no connection has been made.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_MORE_ITEMS</b>
            </para>
          </description>
          <description>
            <para>The operating system cannot automatically choose a local redirection because all the valid local devices are in use.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NET_OR_BAD_PATH</b>
            </para>
          </description>
          <description>
            <para>The operation could not be completed, either because a network component is not started, or because the specified resource name is not recognized.</para>
          </description>
        </item>
        <item>
          <description>
            <para>
              <b>ERROR_NO_NETWORK</b>
            </para>
          </description>
          <description>
            <para>The network is unavailable.</para>
          </description>
        </item>
      </list>
    </returns>
    <remarks>
      <para>
        <b>Windows Server 2003 and Windows XP:  </b>The WNet functions create and delete network drive letters in the MS-DOS device namespace associated with a logon session because MS-DOS devices are identified by AuthenticationID. (An AuthenticationID is the
<a href="https://docs.microsoft.com//windows/desktop/SecGloss/l-gly">locally unique identifier</a>, or LUID, associated with a logon session.) This can affect applications that call one of the WNet functions to create a network drive letter under one user logon, but query for existing network drive letters under a different user logon. An example of this situation could be when a user's second logon is created within a logon session, for example, by calling the
<see cref="CreateProcessAsUser" /> function, and the second logon runs an application that calls the
<see cref="GetLogicalDrives" /> function. <b>GetLogicalDrives</b> does not return network drive letters created by a WNet function under the first logon. Note that in the preceding example the first logon session still exists, and the example could apply to any logon session, including a Terminal Services session. For more information, see
<a href="https://docs.microsoft.com//windows/desktop/FileIO/defining-an-ms-dos-device-name">Defining an MS-DOS Device Name</a>.</para>
      <blockquote>
        <para>[!NOTE]
The winnetwk.h header defines WNetUseConnection as an alias which automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see <a href="https://docs.microsoft.com//windows/win32/intl/conventions-for-function-prototypes">Conventions for Function Prototypes</a>.</para>
      </blockquote>
    </remarks>
    <seealso cref="WNetAddConnection2" />
    <seealso cref="WNetAddConnection3" />
    <seealso cref="WNetGetConnection" />
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-wnet-">Windows
Networking (WNet) Overview</seealso>
    <seealso href="https://docs.microsoft.com//windows/desktop/WNet/windows-networking-functions">Windows
Networking Functions</seealso>
    <seealso cref="WnetCancelConnection" />
  </member>
</doc>